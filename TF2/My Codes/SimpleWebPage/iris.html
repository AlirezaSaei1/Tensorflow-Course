<html>  
    <head></head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script lang="js">     
        
        async function run() {

        }
        
        
        const csvURL = "iris.csv";
            const trainingData = tf.data.csv(csvURL, {
                columnConfig: {
                    species: {
                        isLabel: true
                    }
                }
            });
            
        
        const convertedData = 
                  trainingData.map(({xs, ys}) => {
                      const labels = [
                          ys.species = "setosa" ? 1 : 0,
                          ys.species = "virginica" ? 1 : 0,
                          ys.species = "versicolor" ? 1 : 0
                      ]
                      
            return {xs: Object.values(xs), ys: Object.values(labels)};
                      
        }).batch(10);
        
        
        const numOfFeatures = 4;
        const model = tf.sequential();
        
        model.add(tf.layers.dense({
            inputShape: [numOfFeatures],
            units: 5, 
            activation = "sigmoid"
        }));
        
        model.add(tf.layers.dense({
            units: 3,
            activation: "softmax"
        }));
        
        model.compile({
            loss: "categoricalCrossentropy",
            optimizer: tf.training.adam(0.06)
        });
        
        model.summary();
        
        // Train the model
        await model.fitDataset(
            convertedData,
            {
                epochs:  100,
                callbacks: {
                    onEpochEnd: async(epoch, logs) => {
                        console.log("E: " + epoch + " Loss: " + logs.loss);
                    }
                }
            });

    </script>
    <body>
        <h1>First HTML Page</h1>
    </body>
</html>